<!DOCTYPE html>
<html lang="en-US" dir="ltr">
   <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <!-- ===============================================-->
      <!--    Document Title-->
      <!-- ===============================================-->
      <title>JayHawk+</title>
      <!-- ===============================================-->
      <!--    Favicons-->
      <!-- ===============================================-->
      <link rel="apple-touch-icon" sizes="180x180" href="files/public/assets/img/favicon_package_v0.16/apple-touch-icon-180x180.png">
      <link rel="icon" type="image/png" sizes="32x32" href="files/public/assets/img/favicon_package_v0.16/favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="files/public/assets/img/favicon_package_v0.16/favicon-16x16.png">
      <link rel="android-chrome-192x192" type="image/png" sizes="192x192" href="files/public/assets/img/favicon_package_v0.16/android-chrome-192x192.png">
      <link rel="android-chrome-512x512" type="image/png" sizes="512x512" href="files/public/assets/img/favicon_package_v0.16/android-chrome-512x512.png">
      <link rel="manifest" href="files/public/assets/img/favicon_package_v0.16/site.webmanifest">
      <link rel="mask-icon" href="files/public/assets/img/favicon_package_v0.16/safari-pinned-tab.svg" color="#5bbad5">
      <meta name="msapplication-TileColor" content="#ffc40d">
      <meta name="theme-color" content="#ffffff">
      <!-- ===============================================-->
      <!--    Stylesheets-->
      <!-- ===============================================-->
      <link href="files/public/assets/css/theme.css" rel="stylesheet" />
      <script src="daypilot-javascript.min.js" type="text/javascript"></script>
   </head>
   <body onload="loadEvents()">
      <!-- ===============================================-->
      <!--    Main Content-->
      <!-- ===============================================-->
      <main class="main" id="top">
         <nav class="navbar navbar-expand-lg navbar-light" data-navbar-on-scroll="data-navbar-on-scroll">
            <div class="container">
               <a class="navbar-brand" href="index.html"><img src="files/public/assets/img/gallery/jayhaw.png" width="118" alt="logo" /></a>
               <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"> </span></button>
               <div class="collapse navbar-collapse border-top border-lg-0 mt-4 mt-lg-0" id="navbarSupportedContent">
                  <ul class="navbar-nav ms-auto pt-2 pt-lg-0 font-base">
                     <li class="nav-item px-2"><a class="nav-link" href="help.html">Help</a></li>
                  </ul>
                  <a class="btn btn-sm btn-outline-primary rounded-pill order-1 order-lg-0 ms-lg-4" onclick="logout()">Logout</a>
               </div>
            </div>
         </nav>
         <!-- ============================================-->
         <!-- <section> begin ============================-->
         <section class="py-5" id="departments">
            <div class="container">
               <div class="row">
                  <div class="col-12 py-3">
                     <div class="bg-holder bg-size" style="background-image:url(files/public/assets/img/gallery/bg-departments.png);background-position:top center;background-size:contain;">
                     </div>
                     <!--/.bg-holder-->
                     <h2 class="text-center">JayHawk+</h2>
                  </div>
               </div>
            </div>
            <!-- end of .container-->
         </section>
         <!-- <section> close ============================-->
         <!-- ============================================-->
         <section class="py-0">
            <div class="container">
               <div class="row py-5 align-items-center justify-content-center justify-content-lg-evenly">
                  <div class="col-auto col-md-4 col-lg-auto text-xl-start">
                     <div class="d-flex flex-column align-items-center">
                        <div class="icon-box text-center">
                           <a class="text-decoration-none" href="appointment.html">
                              <img class="mb-3 deparment-icon" src="files/public/assets/img/icons/neurology.png" alt="..." /><img class="mb-3 deparment-icon-hover" src="files/public/assets/img/icons/neurology.svg" alt="..." />
                              <p class="fs-1 fs-xxl-2 text-center">Book Appointments</p>
                           </a>
                        </div>
                     </div>
                  </div>
                  <div class="col-auto col-md-4 col-lg-auto text-xl-start">
                     <div class="d-flex flex-column align-items-center">
                        <div class="icon-box text-center">
                           <a class="text-decoration-none" href="reports.html">
                              <img class="mb-3 deparment-icon" src="files/public/assets/img/icons/eye-care.png" alt="..." /><img class="mb-3 deparment-icon-hover" src="files/public/assets/img/icons/eye-care.svg" alt="..." />
                              <p class="fs-1 fs-xxl-2 text-center">View Reports</p>
                           </a>
                        </div>
                     </div>
                  </div>
                  <div class="col-auto col-md-4 col-lg-auto text-xl-start">
                     <div class="d-flex flex-column align-items-center">
                        <div class="icon-box text-center">
                           <a class="text-decoration-none" href="meetings.html">
                              <img class="mb-3 deparment-icon" src="files/public/assets/img/icons/cardiac.png" alt="..." /><img class="mb-3 deparment-icon-hover" src="files/public/assets/img/icons/cardiac.svg" alt="..." />
                              <p class="fs-1 fs-xxl-2 text-center">1-1 Chat</p>
                           </a>
                        </div>
                     </div>
                  </div>
                  <div class="col-auto col-md-4 col-lg-auto text-xl-start">
                     <div class="d-flex flex-column align-items-center">
                        <div class="icon-box text-center">
                           <a class="text-decoration-none" href="profile.html">
                              <img class="mb-3 deparment-icon" src="files/public/assets/img/icons/heart.png" alt="..." /><img class="mb-3 deparment-icon-hover" src="files/public/assets/img/icons/heart.svg" alt="..." />
                              <p class="fs-1 fs-xxl-2 text-center">Profile</p>
                           </a>
                        </div>
                     </div>
                  </div>
               </div>
            </div>
            <!-- end of .container-->
         </section>
         
         <h3 style="text-align: center;">My Bookings</h3>
          <section class="cal">
            <script src="daypilot-javascript.min.js" type="text/javascript"></script>
            <!--<div id="nav"></div>-->
            <div id="dp"></div>
            <script type="text/javascript">
    
               var username= sessionStorage.getItem("username");           
               /*const nav = new DayPilot.Navigator("nav", {
               showMonths: 0,
               skipMonths: 1,
               selectMode: "Week",
               onTimeRangeSelected: args => {
                 dp.update({startDate: args.day});
                 app.loadEvents();
               }
               });
             nav.init();*/
               const dp = new DayPilot.Month("dp");
               dp.eventDeleteHandling = "Update";

               dp.onEventDelete = function(args) {
               if (!confirm("Do you really want to cancel this booking?")) {
                   args.preventDefault();
               }
               };

                dp.onEventDeleted = function(args) {

                var username = sessionStorage.getItem("username");
                var appt_id = args.e.id();

                const Patient = {
                username: username,
                appt_id: appt_id
            	};

            	const otherParam = {
                headers:{
                    "content-type":"application/json; charset=UTF-8"
                },
                 body: JSON.stringify(Patient),
                 method:"POST"
                }
                console.log()
                var valid = false;
                fetch("https://localhost:44354/Remove", otherParam)
                .then(data =>{return data.json()})
                .then(res=>{if(res == true)
                {
                    alert("Appointment Deleted");
                }
                else
                {
                    alert("Error");
                }})
                .catch(error=>console.log(error))
                };

               dp.init();
               
               function logout(){
                  sessionStorage.clear();
                  window.location.assign("login.html");
               }
               async function loadEvents() {
               const start = dp.visibleStart();
               const end = dp.visibleEnd();
               const {data} = await DayPilot.Http.get("https://localhost:44354/getAppointments?username=" + username);
               console.log(data);
               dp.update({
                   events: data
               });
           }
           </script>
          </section>
          <section class="py-0 bg-primary">
            <div class="container">
               <div class="row justify-content-evenly py-4">
                  <div class="col-12 col-sm-8 col-md-6 col-lg-auto text-center text-md-start">
                     <p class="fs--1 my-2 fw-bold text-200" style="text-align: center;">All rights Reserved &copy; Team HawkPlus</p>
                  </div>
               </div>
            </div>
            <!-- end of .container-->
          </section>
      </main>
      <!-- ===============================================-->
      <!--    End of Main Content-->
      <!-- ===============================================-->
      <!-- ===============================================-->
      <!--    JavaScripts-->
      <!-- ===============================================-->
      <script src="vendors/@popperjs/popper.min.js"></script>
      <script src="vendors/bootstrap/bootstrap.min.js"></script>
      <script src="vendors/is/is.min.js"></script>
      <script src="https://scripts.sirv.com/sirvjs/v3/sirv.js"></script>
      <script src="https://polyfill.io/v3/polyfill.min.js?features=window.scroll"></script>
      <script src="vendors/fontawesome/all.min.js"></script>
      <script src="assets/js/theme.js"></script>
      <link rel="preconnect" href="https://fonts.googleapis.com">
      <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
      <link href="https://fonts.googleapis.com/css2?family=Fjalla+One&amp;family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100&amp;display=swap" rel="stylesheet">
   </body>
</html>